<html xmlns:DSCom>
<head>
<title> - -选择日期 - - &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</title>
<script>
    //*************************日历控件***************************
    // cody by [STAR].sjz  2003-10-31
    // 说明:返回值为 一个字符串
    // 使用方法  : 
    // 	var dataString = showModalDialog("calendar.htm", "dd日mm月yyyy年" ,"dialogWidth:286px;dialogHeight:221px;status:no;help:no;");
    /**
     * 避免点击关闭窗口时返回当前选中日期号
     */

    window.onload = function(){
        if( window.dialogArguments[0]==null){
            var date = new Date();
            var Nyear = date.getYear();
            var Nmonth =  date.getMonth() +1;
            var Ndate =  date.getDate();

            hours.selectedIndex = date.getHours();
            minutes.selectedIndex = date.getMinutes();
            seconds.selectedIndex = date.getSeconds();
        }else{
            var date = window.dialogArguments[0];
            var Nyear = date.getYear();
            var Nmonth =  date.getMonth() +1;
            var Ndate =  date.getDate();

            hours.selectedIndex = date.getHours();
            minutes.selectedIndex = date.getMinutes();
            seconds.selectedIndex = date.getSeconds();
        }

        window.document.attachEvent("onclick" , doCmd);
        window.document.attachEvent("onmouseover" , buttonOver);
        window.document.attachEvent("onmouseout" , buttonOut);
        window.document.attachEvent("onmousedown" , buttonDown);
        window.document.attachEvent("onmouseup" , buttonUp);
        window.document.attachEvent("ondblclick" ,	 function(e){obj = e.srcElement;if(obj.tagName.toLowerCase() == "span"  &&  obj.parentNode.className.replace(/Ctable/ig,"star") == "star" )getResault(e.srcElement);}	);

        document.all.titleYear.innerHTML=TranYearMonthTitle(Nyear,Nmonth);
        document.all.weekNameBox.insertAdjacentHTML("afterBegin",makeWeekNameHtmlStr());
        document.all.calendarBox.innerHTML=makeCalendarHtmlStr(Nyear,Nmonth);
        window.currentSelectDate = starCaTran(Nyear,Nmonth,Ndate);
        window.document.all.calendarBox.show = show;
        window.currentActiveItem = window.document.getElementById(currentSelectDate);
        if( window.currentActiveItem ){
            window.currentActiveItem.click();
        }
        window.document.all.calendarBox.show();

        if(window.dialogArguments[1]=="true"){
            emptyBox.style.display="";
        }
    }

     function dataObj(year,month,date){
        this.year		=	year
        this.month	=	month
        this.date		=  date
        this.getDateString = function(formatString){
            return formatString.replace(/yyyy/ig , this.year<2000?"19"+this.year:this.year).replace(/mm/ig , this.month).replace(/dd/ig , this.date)
        }
        this.getDateValue = function(){
            return new Date(year+"/"+month+"/"+date).valueOf();
        }
    }

    function getResault(value){
            var obj = window.currentActiveItem;

            if(value == "none"){
                window.returnValue = "";
                return window.close();
            }
            if(value == "cancle" || !obj){
                window.returnValue = null;
                return window.close();
            }
            if(obj && (/-/ig).test(obj.id)){
                var year = obj.id.split("-")[0];
                var month = obj.id.split("-")[1];
                var date = obj.id.split("-")[2];

                //2008-6-20 解决19xx年日期问题
                if(4 > year.length){
                    year = "19" + year;
                }

                var hour = hours.value;
                var minute = minutes.value;
                var second = seconds.value;

                var iDate = new Date(year + "/" + month + "/" + date + " " + hour + ":" + minute + ":" + second).valueOf();
                window.returnValue = iDate;

                return window.close();
            }
    }



    function starCalendar(year,month){
        this.year = year;
        this.month = month;
        this.monthTable = function(){
            var aMonth=new Array();
            for(i=1;i<7;i++){
              aMonth[i]=new Array(i);
            }

            var dCalDate=new Date(this.year, this.month-1, 1);
            var iDayOfFirst=dCalDate.getDay();
            var iDaysInMonth=new Date(this.year, this.month, 0).getDate();
            var iOffsetLast=new Date(this.year, this.month-1, 0).getDate()-iDayOfFirst+1;
            var iDate = 1;
            var iNext = 1;

            for (d = 0; d < 7; d++){
                aMonth[1][d] = (d<iDayOfFirst)?(-iDayOfFirst+d+1):iDate++;
            }
            for (w = 2; w < 7; w++){
                for (d = 0; d < 7; d++){
                    aMonth[w][d] = iDate++;
                }
            }
            return aMonth;
        }
    }
    function makeWeekNameHtmlStr(){
        var tmpStr="";
        var weekName = ["日","一","二","三","四","五","六"];
        for(var i=0;i<7;i++){
            tmpStr+="<span class=weekName>"+weekName[i]+"</span>";
        }
        return tmpStr;
    }
    function makeCalendarHtmlStr(year,month){
        window.theCalendar = new starCalendar(year,month);
        var theCaArr = theCalendar.monthTable();
        var theDaysInMonth = new Date(year, month, 0).getDate();
        var theCaHtml = "<div class=Ctable>";
        for(var i=1;i<7;i++){
            for(var j=0;j<7;j++){
                theCaHtml = theCaHtml+"<span class="+( (theCaArr[i][j]<1 || theCaArr[i][j]>theDaysInMonth)?"OtherMonthDate":"Cdate")+" id="+starCaTran(year,month,theCaArr[i][j])+">"+starCaTran(year,month,theCaArr[i][j]).split("-")[2]+"</span>";
            }
        }
        return theCaHtml+"</div>";
    }
    function starCaTran(year,month,date){
        with(new Date(year,month-1,date)){
            return getYear() + "-" +(getMonth()+1) + "-" + getDate();
        }
    }
    function TranYearMonthTitle(year,month){
        with(new Date(year,month-1,1)){
            return "<span style='text-decoration:underline;cursor:hand;font-weight:bold;font:10px verdana;padding:0 2 0 1;width:40px;color:#fff;' onclick=showMore(1940,2100,this.innerHTML) onmouseover=\"this.runtimeStyle.cssText='color:#fff;'\" onmouseout=\"this.runtimeStyle.cssText=''\" onpropertychange=showC()>" + ( getYear()<2000?"19"+getYear():getYear() )+ "</span><span style='font:9px Webdings;width:5px;padding:0px;margin-left:-5px;'>6</span>" + "年" + "<span style='text-decoration:underline;cursor:hand;font-weight:bold;padding:1 2 0 1;width:20px;font:10px verdana;color:#fff;' onclick=showMore(1,12,this.innerHTML) onmouseover=\"this.runtimeStyle.cssText='color:#fff;'\" onmouseout=\"this.runtimeStyle.cssText=''\" onpropertychange=showC()>" + (getMonth()+1) + "</span><span style='font:9px Webdings;width:5px;padding:0px;margin-left:-5px;'>6</span>" + "月" ;
        }
    }

    function showC(){
        if(event.propertyName != "innerHTML")return;
        window.theCalendar.year = new Number(document.all.titleYear.getElementsByTagName("span")[0].innerHTML);
        window.theCalendar.month =  new Number(document.all.titleYear.getElementsByTagName("span")[2].innerHTML);
        window.document.all.calendarBox.innerHTML=makeCalendarHtmlStr(window.theCalendar.year,window.theCalendar.month);
        window.document.all.calendarBox.show = show;
        window.document.all.calendarBox.show();
    }
    function showMore(starNum,endNum,selectedValue){
        var obj = window.event.srcElement;
        var selectedIndex = selectedValue - starNum;

        if(obj.selectBox){
            obj.selectBox.selectedIndex = selectedIndex;
            return obj.selectBox.show(document.all.calendarBox.offsetHeight + document.all.weekNameBox.offsetHeight );
        }
        var selectBox = window.document.createElement("div");
        selectBox.className = "selectBox";
        selectBox.style.height = 0;
        selectBox.style.top = window.event.clientY - window.event.offsetY + window.event.srcElement.offsetHeight;
        selectBox.style.left = window.event.clientX - window.event.offsetX ;
        selectBox.show  = showBox;
        selectBox.selectedIndex = selectedIndex;
        selectBox.onclick = function(){
            var selectedObj = window.event.srcElement;
            if( "nobr" == selectedObj.tagName.toLowerCase() && selectBox.contains(selectedObj)){
                if(obj.innerHTML != selectedObj.innerHTML)obj.innerHTML = selectedObj.innerHTML;
            }
        }
        selectBox.onlosecapture = alert
        var iString = "";
        for(var i=starNum;i<=endNum;i++){
            iString += "<nobr  onmouseover=\"this.parentNode.getElementsByTagName('nobr')[this.parentNode.selectedIndex].style.cssText='';this.style.cssText='background-color:#00006C;color:#fff;'\"  onmouseout=this.style.cssText=''>"+i+"</nobr><br>"	
        }
        selectBox.insertAdjacentHTML ("afterBegin",iString);
        window.document.body.appendChild(selectBox);
        obj.selectBox = selectBox;
        obj.selectBox.show(document.all.calendarBox.offsetHeight + document.all.weekNameBox.offsetHeight );
        
    }


    function showBox(iHeight){
        var box = this;
        box.style.height =1;
        box.style.display = "block";
        window.clearInterval(box.timeHandle);
        box.timeHandle = window.setInterval(interValHandle,1);

        var s = 0,t =1 ;
        function interValHandle(){
            box.scrollTop=1000000;
            s = s + t*t;
            t += 0.5;
            box.style.height = parseInt(box.style.height) + Math.floor(s);
            box.style.width = 65 / iHeight * box.offsetHeight;
            if( box.offsetHeight > iHeight ){
                window.clearInterval(box.timeHandle);
                box.style.height = iHeight;
                box.scrollTop = box.childNodes[0].offsetHeight*box.selectedIndex;
                box.getElementsByTagName("nobr")[box.selectedIndex].style.cssText='background-color:#00006C;color:#fff;';
                window.document.attachEvent("onclick",
                    box.hide=function(){
                        box.style.display = "none";
                        window.document.detachEvent("onclick",box.hide)
                    }
                );
            }
        }
    }


    </script>

    <script>

    function buttonOver(eventObj){
        var obj = eventObj.srcElement;
        if(obj==null || !obj.nodeType)return;

        if(obj.tagName.toLowerCase() == "span"  &&  obj.className.replace(/controlButton/ig,"star") == "star" ){
            obj.runtimeStyle.cssText="border-color:#fff #606060 #808080 #fff;padding:3 0 0 0 ";
        }
    }
    function buttonOut(eventObj){
        var obj = eventObj.srcElement;
        if(!obj.nodeType)return;

        if(obj.tagName.toLowerCase() == "span"  &&  obj.className.replace(/controlButton/ig,"star") == "star" ){
            obj.runtimeStyle.cssText = "";
        }
        if(obj.tagName.toLowerCase() == "span"  &&  obj.parentNode.className.replace(/Ctable/ig,"star") == "star" ){
            window.setTimeout(function(){obj.style.backgroundColor = ""; },0);
        }
    }
    function buttonDown(eventObj){
        var obj = eventObj.srcElement;
        if(!obj.nodeType)return;

        if(obj.tagName.toLowerCase() == "span"  &&  obj.className.replace(/controlButton/ig,"star") == "star" ){
            obj.setCapture();
            obj.runtimeStyle.borderColor="#808080 #fefefe #fefefe #808080";
        }
    }
    function buttonUp(eventObj){
        var obj = eventObj.srcElement;
        if(!obj.nodeType)return;

        if(obj.tagName.toLowerCase() == "span"  && obj.className.replace(/controlButton/ig,"star") == "star" ){
            obj.releaseCapture();
            obj.runtimeStyle.cssText ="";
        }
    }
    function doCmd(eventObj){
        var obj = window.event.srcElement;
        if(obj.tagName.toLowerCase() == "span"  &&  obj.parentNode.className.replace(/Ctable/ig,"star") == "star" ){
            try{
                window.currentActiveItem.runtimeStyle.cssText = "";
            }
            catch(e){	}
            Nyear = obj.id.split("-")[0];
            Nmonth = obj.id.split("-")[1];
            Ndate = obj.id.split("-")[2];
            window.currentActiveItem = obj;
            window.currentSelectDate = window.currentActiveItem.id;
            window.currentActiveItem.runtimeStyle.cssText = "border:1px inset;color:#fff;background-color:#808080;font-size:11px;font-weight:bold";
            window.document.all.statusBload.innerHTML ="当前选中的日期:"+ ( Nyear<2000?"19"+Nyear:Nyear )+"年"+Nmonth+"月"+Ndate+"日"
        }

        var obj = eventObj.srcElement;
        if(!obj.nodeType)return;

        if(obj.tagName.toLowerCase() == "span"  && obj.className.replace(/controlButton/ig,"star") == "star" ){
            switch(obj.getAttribute("cmd")){
                case "py":
                    window.document.all.titleYear.innerHTML=window.TranYearMonthTitle(window.theCalendar.year-1,window.theCalendar.month);
                    window.document.all.calendarBox.innerHTML=makeCalendarHtmlStr(window.theCalendar.year-1,window.theCalendar.month);
                    break;
                case "pm":
                    window.document.all.titleYear.innerHTML=window.TranYearMonthTitle(window.theCalendar.year,window.theCalendar.month-1);
                    window.document.all.calendarBox.innerHTML=makeCalendarHtmlStr(window.theCalendar.year,window.theCalendar.month-1);
                    break;
                case "nm":
                    window.document.all.titleYear.innerHTML=window.TranYearMonthTitle(window.theCalendar.year,window.theCalendar.month+1);
                    window.document.all.calendarBox.innerHTML=makeCalendarHtmlStr(window.theCalendar.year,window.theCalendar.month+1);
                    break;
                case "ny":
                    window.document.all.titleYear.innerHTML=window.TranYearMonthTitle(window.theCalendar.year+1,window.theCalendar.month);
                    window.document.all.calendarBox.innerHTML=makeCalendarHtmlStr(window.theCalendar.year+1,window.theCalendar.month);
                    break;
            }
            window.document.all.calendarBox.show();
            window.currentSelectDate = starCaTran(Nyear,Nmonth,Ndate);
            window.currentActiveItem = window.document.getElementById(currentSelectDate);
            if( window.currentActiveItem ){
                window.currentActiveItem.runtimeStyle.cssText = "border:1px inset;color:#fff;background-color:#808080;font-size:11px;font-weight:bold";
            }
        }
    }
    function show(){
    }
</script>
<style>
*{
	font:12px;
	letter-spacing:0px;
}
body{
	overflow:hidden;
	margin:0px;
	border:solid threeDface;
	border-width:7px;
	background-color:threeDface;
}
#titleYear{
	text-align:center;
	padding-top:3px;
	width:120px;
	height:26px;
	border:1px outset;
	background-color:#808080;
	color:#D4D0C8;
	cursor:default;
}
#weekNameBox{
	width:282px;
	border-bottom:0;
}
.weekName{
	width:282px;
	text-align:center;
	padding-top:4px;
	width:40px;
	height:26px;
	border:1px outset;
	background-color:#808080;
	color:#D4D0C8;
	cursor:default;
}
.controlButton{
	font-family: Webdings;
	font:9px;
	text-align:center;
	padding-top:2px;
	width:40px;
	height:26px;
	border:1px outset;
	background-color:#808080;
	color:#000000;
	cursor:default;
}

.Ctable{
	width:282px;
}
.Ctable span{
	font:10px verdana;
	color:#000000;
	text-align:center;
	padding-top:4px;
	width:40px;
	height:22px;
	border-style:solid;
	border-width:1px 1px 1px 1px;
	border-color:#ffffff #808080 #808080 #ffffff;
	cursor:default;
}
.Cdate{
	background-color:buttonFace;
}
.Ctable span.OtherMonthDate{
	color:#999;
	background-color:#f6f6f6;
}
.selectedSpan{
	background-color:#808080;
	border:1px inset;
}

.selectBox{
	cursor:hand;
	font:9px verdana;
	width:80px;
	position:absolute;
	border:1px solid #333333;
	overflow-y:scroll;
	overflow-x:hidden;
	background-color:#fff;
	FILTER:progid:DXImageTransform.Microsoft.Shadow(Color=#999999,offX=10,offY=10,direction=120,Strength=5);
	SCROLLBAR-FACE-COLOR: #eeeee6;
	SCROLLBAR-HIGHLIGHT-COLOR: #ffffff;
	SCROLLBAR-SHADOW-COLOR: #808080; 
	SCROLLBAR-3DLIGHT-COLOR: #808080; 
	SCROLLBAR-ARROW-COLOR:  #000000; 
	SCROLLBAR-TRACK-COLOR: #eeeee6; 
	SCROLLBAR-DARKSHADOW-COLOR: #ffffff;
}
.selectBox nobr{
	padding:0px 0px 2px 5px;
	width:100%;
	color:#000;
	letter-spacing:2px;
	text-decoration:none;
}
#statusBload {
    font:12px verdana;
    padding:4px;
    height:1px;
    border:1px solid #808080;
    margin:0px 3px 5px 0px;
    background-color:#ffffff;
}
#time {
    margin-top:5px;
    font-size:16px;
    letter-spacing:-8px;
}
#time select{
    position:relative;
    top:3px;
}

</style>
</head>
<body onselectstart="return false">
<div id=statusBload></div>
<div>
  <table cellpadding=0 cellspacing=0 border=0 style="margin-right:-2px;margin-bottom:-1px;">
    <tr>
      <td>
        <div id=controlBar>
          <span class=controlButton cmd=py title=上一年>33</span><span class=controlButton cmd=pm title=上一月>3</span><span id=titleYear></span><span class=controlButton  cmd=nm title=下一月>4</span><span class=controlButton cmd=ny title=下一年>44</span>
        </div>
        <div id=weekNameBox></div><div id=calendarBox></div>
      </td>
    </tr>
  </table>
  <div id="time">
    <select id=hours>
      <option value="00">00</option>
      <option value="01">01</option>
      <option value="02">02</option>
      <option value="03">03</option>
      <option value="04">04</option>
      <option value="05">05</option>
      <option value="06">06</option>
      <option value="07">07</option>
      <option value="08">08</option>
      <option value="09">09</option>
      <option value="10">10</option>
      <option value="11">11</option>
      <option value="12">12</option>
      <option value="13">13</option>
      <option value="14">14</option>
      <option value="15">15</option>
      <option value="16">16</option>
      <option value="17">17</option>
      <option value="18">18</option>
      <option value="19">19</option>
      <option value="20">20</option>
      <option value="21">21</option>
      <option value="22">22</option>
      <option value="23">23</option>
    </select> :
    <select id=minutes>
      <option value="00">00</option>
      <option value="01">01</option>
      <option value="02">02</option>
      <option value="03">03</option>
      <option value="04">04</option>
      <option value="05">05</option>
      <option value="06">06</option>
      <option value="07">07</option>
      <option value="08">08</option>
      <option value="09">09</option>
      <option value="10">10</option>
      <option value="11">11</option>
      <option value="12">12</option>
      <option value="13">13</option>
      <option value="14">14</option>
      <option value="15">15</option>
      <option value="16">16</option>
      <option value="17">17</option>
      <option value="18">18</option>
      <option value="19">19</option>
      <option value="20">20</option>
      <option value="21">21</option>
      <option value="22">22</option>
      <option value="23">23</option>
      <option value="24">24</option>
      <option value="25">25</option>
      <option value="26">26</option>
      <option value="27">27</option>
      <option value="28">28</option>
      <option value="29">29</option>
      <option value="30">30</option>
      <option value="31">31</option>
      <option value="32">32</option>
      <option value="33">33</option>
      <option value="34">34</option>
      <option value="35">35</option>
      <option value="36">36</option>
      <option value="37">37</option>
      <option value="38">38</option>
      <option value="39">39</option>
      <option value="40">40</option>
      <option value="41">41</option>
      <option value="42">42</option>
      <option value="43">43</option>
      <option value="44">44</option>
      <option value="45">45</option>
      <option value="46">46</option>
      <option value="47">47</option>
      <option value="48">48</option>
      <option value="49">49</option>
      <option value="50">50</option>
      <option value="51">51</option>
      <option value="52">52</option>
      <option value="53">53</option>
      <option value="54">54</option>
      <option value="55">55</option>
      <option value="56">56</option>
      <option value="57">57</option>
      <option value="58">58</option>
      <option value="59">59</option>
    </select> :
    <select id=seconds>
      <option value="00">00</option>
      <option value="01">01</option>
      <option value="02">02</option>
      <option value="03">03</option>
      <option value="04">04</option>
      <option value="05">05</option>
      <option value="06">06</option>
      <option value="07">07</option>
      <option value="08">08</option>
      <option value="09">09</option>
      <option value="10">10</option>
      <option value="11">11</option>
      <option value="12">12</option>
      <option value="13">13</option>
      <option value="14">14</option>
      <option value="15">15</option>
      <option value="16">16</option>
      <option value="17">17</option>
      <option value="18">18</option>
      <option value="19">19</option>
      <option value="20">20</option>
      <option value="21">21</option>
      <option value="22">22</option>
      <option value="23">23</option>
      <option value="24">24</option>
      <option value="25">25</option>
      <option value="26">26</option>
      <option value="27">27</option>
      <option value="28">28</option>
      <option value="29">29</option>
      <option value="30">30</option>
      <option value="31">31</option>
      <option value="32">32</option>
      <option value="33">33</option>
      <option value="34">34</option>
      <option value="35">35</option>
      <option value="36">36</option>
      <option value="37">37</option>
      <option value="38">38</option>
      <option value="39">39</option>
      <option value="40">40</option>
      <option value="41">41</option>
      <option value="42">42</option>
      <option value="43">43</option>
      <option value="44">44</option>
      <option value="45">45</option>
      <option value="46">46</option>
      <option value="47">47</option>
      <option value="48">48</option>
      <option value="49">49</option>
      <option value="50">50</option>
      <option value="51">51</option>
      <option value="52">52</option>
      <option value="53">53</option>
      <option value="54">54</option>
      <option value="55">55</option>
      <option value="56">56</option>
      <option value="57">57</option>
      <option value="58">58</option>
      <option value="59">59</option>
    </select>
  <div>
</div>
<hr />
<table width=100% cellspacing=0 cellpadding=0 border=0>
  <tr>
    <td>
      <Button onclick="getResault('none')" style="width:75px;" id="emptyBox">置 空</Button>
    </td>
    <td align=right>
      <Button onclick="getResault('normal')" style="width:75px;" tabIndex=1><img src="ok.gif" style="margin:0px 5px 0px 0px;" align="absmiddle"/>确 定</Button>
      <Button  onclick="getResault('cancle')" style="width:75px;"><img src="cancel.gif" style="margin:0px 5px 0px 0px;" align="absmiddle"/>取 消</Button>
    </td>
  </tr>
</table>
</body>