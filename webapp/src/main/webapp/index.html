<!DOCTYPE html>
<html> 
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>    
<meta charset="UTF-8">
<title>它山石</title>
<link rel="shortcut icon" href="images/tss.ico">
<link rel="Bookmark" href="images/tss.ico">

<link href="tools/tssJS/css/boubei.css" rel="stylesheet">
<link href="css/css.css" rel="stylesheet">

<script src="tools/tssJS/tssJS.all.js"></script>

<style>

/* 顶部 */
.top { height: 40px; background-color: black; }
.top .logo { display: inline-block; text-decoration: none; padding: .5em 1em; color: #fff; }
.top .logo .forename { font-weight: bold; font-size: 22px;color: #4ecdc4 }
.top .logo .surname  { font-weight: normal; font-size: 20px; color: #fff }

.menu a:hover {  text-decoration: none; }
.menu { margin:1px 0px; position:absolute; top:0px; right:0px; font-size:13px; } 
.menu ul { list-style-type: none; } 
.menu ul li { float:left; position:relative; width:88px; text-align:center; } 
.menu ul li a, 
.menu ul li a:visited { 
	display:block; height:25px; line-height:25px; 
	color: #333; background: #049cdb; 
} 
.menu ul li ul { display: none; } 
.menu ul li:hover a { color:#fff; background:#AFEEEE; border-bottom:1px solid #fff; } 
.menu ul li:hover ul { display:block; position:absolute; top:25px; left:0; width:88px; } 
.menu ul li:hover ul li a { display:block; background:#049cdb; color:#333; } 
.menu ul li:hover ul li a:hover { color:#fff; font-weight:bold; } 

</style>

<script type="text/javascript">
	
FROMEWORK_CODE = "TSS";
APP_CODE    = "TSS";
APPLICATION = APP_CODE.toLowerCase();
CONTEXTPATH = APPLICATION + "/";

/* 用户信息初始化  */
window.onload = function() {
	$.ajax({
		url : "auth/user/operatorInfo",
		method : "POST",
		headers: {"appCode": APP_CODE},
		params : {"anonymous": "true"}, 
		onresult : function() {
			var userName = this.getNodeValue("name");
			$("#userInfo").html(userName || '个人信息');
			
			resizeIFrame();
			turn2IFrame("modules/dm/record.html");

			dbsx();
		}
	});
}

function dbsx() {
  $.ajax({
    url: "auth/message/num",
    method: "GET",
    type : "json",
    ondata: function() {
      var num = this.getResponseJSON();
      if(num > 0) {
        $.tssTip("您的站内信箱里有<b> " + num + " </b>条新的待办事项，<a href='javascript:void(0)' onclick='openMsgPage()'>点击查看。</a>");
      }
    }
  });
}

function openMsgPage() {
	turn2IFrame('modules/um/message.html');
}

var resizeIFrame = function resizeIFrame() {
	$("#iframeSrc").css("height", (document.body.offsetHeight - 41) + "px");
}

window.onresize = resizeIFrame;

function logout() {
	$.ajax({
		url : "logout.in",
		method : "GET",
		onsuccess : function() { 
			$.Cookie.del("token", "");
			$.Cookie.del("token", "/");
			$.Cookie.del("token", "/" + APPLICATION);
			$.Cookie.del("token", "/" + CONTEXTPATH);
			location.href = "login.html";
		}
	});
}

function turn2IFrame(ahref) {
	if (ahref != "#") {
		$1("iframeSrc").setAttribute("src", ahref);
	}
}

</script>

</head>

<body>
 
<div class="top">
	<div class="logo">
		<b class="forename">它山石</b><b class="surname">数据管理平台</b>
	</div>
	<div class="menu"> 
		<ul> 
			<li><a href='javascript:void(0)'>数据管理</a> 	 
				<ul> 
					<li><a href='javascript:void(0)' onclick="turn2IFrame('modules/dm/report.html')">数据报表</a> </li> 
					<li><a href='javascript:void(0)' onclick="turn2IFrame('modules/dm/record.html')">数据录入</a> </li>
					<li><a href='javascript:void(0)' onclick="turn2IFrame('modules/cms/channel.html')">栏目内容</a></li> 
				</ul> 
			</li>  
			<li><a href='javascript:void(0)'>用户权限</a> 	 
				<ul> 
					<li><a href='javascript:void(0)' onclick="turn2IFrame('modules/um/group.html')">用户管理</a> </li> 
					<li><a href='javascript:void(0)' onclick="turn2IFrame('modules/um/resource.html')">应用资源</a> </li> 
					<li><a href='javascript:void(0)' onclick="turn2IFrame('modules/um/role.html')">角色授权</a> </li> 
					<li><a href='javascript:void(0)' onclick="turn2IFrame('modules/um/subauth.html')">权限转授</a> </li> 
				</ul> 
			</li> 
			<li><a href='javascript:void(0)'>门户管理</a> 	 
				<ul> 
					<li><a href='javascript:void(0)' onclick="turn2IFrame('modules/portal/structure.html')">门户结构</a> </li> 
					<li><a href='javascript:void(0)' onclick="turn2IFrame('modules/portal/component.html')">门户组件</a> </li> 
					<li><a href='javascript:void(0)' onclick="turn2IFrame('modules/portal/release.html')">门户发布</a> </li>
					<li><a href='javascript:void(0)' onclick="turn2IFrame('modules/portal/navigator.html')">菜单导航</a> </li> 
				</ul> 
			</li> 
			<li><a href='javascript:void(0)'>系统辅助</a> 	 
				<ul> 
					<li><a href='javascript:void(0)' onclick="turn2IFrame('modules/_log/log.htm')">日志查询</a> </li> 
					<li><a href='javascript:void(0)' onclick="turn2IFrame('modules/_param/param.htm')">系统参数</a> </li> 
					<li><a href='javascript:void(0)' onclick="turn2IFrame('modules/_cache/cache.htm')">缓存管理</a> </li> 
					<li><a href='javascript:void(0)' onclick="turn2IFrame('modules/um/_password.htm');">修改密码</a></li>
				</ul> 
			</li> 	
			<li><a href='javascript:void(0)' onclick="openMsgPage()">待办事项</a> </li> 
            <li><a href='javascript:void(0)' onclick="turn2IFrame('modules/um/_userInfo.htm');"><span id="userInfo">个人信息</span></a></li>
			<li><a href='javascript:void(0)' onclick="logout()"> 注销登陆</a></li> 
		</ul>  
	</div> 
</div>

<iframe id="iframeSrc" width="100%" height="100%" frameborder="0"/>
 
</body>
</html>